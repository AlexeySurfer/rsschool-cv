(()=>{"use strict";var e,t,n,s,i,a={203:(e,t,n)=>{n.d(t,{zy:()=>l,DT:()=>c,Bo:()=>o,tD:()=>d,oX:()=>h,ix:()=>m,BL:()=>g,sT:()=>p,Ag:()=>v,P8:()=>E,H9:()=>w,MG:()=>u,IO:()=>y,BS:()=>f});const s="http://127.0.0.1:3000/",i=`${s}garage`,a=`${s}winners`,r=`${s}engine`,l=async(e=1,t=7)=>{const n=await fetch(`${i}?_page=${e}&_limit=${t}`);return{items:await n.json(),count:n.headers.get("X-Total-Count")}},c=async e=>(await fetch(i,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json(),o=async(e,t)=>(await fetch(`${i}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json(),d=async e=>(await fetch(`${i}/${e}`,{method:"DELETE"})).json(),h=async e=>(await fetch(`${i}/${e}`)).json(),m=async(e=1,t=10,n="ASC",s="time")=>{const i=await fetch(`${a}?_page=${e}&_limit=${t}&_sort=${s}&_order=${n}`);return{items:await i.json(),count:i.headers.get("X-Total-Count")}},g=async e=>(await fetch(`${r}?id=${e}&status=started`)).json(),p=async e=>(await fetch(`${r}?id=${e}&status=stopped`)).json(),v=async e=>{const t=await fetch(`${r}?id=${e}&status=drive`).catch();return 200!==t.status?{success:!1}:Object.assign({},await t.json())},E=async e=>(await fetch(a,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json(),w=async e=>(await fetch(`${a}/${e}`)).json(),u=async e=>(await fetch(`${a}/${e}`)).status,y=async(e,t)=>(await fetch(`${a}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json(),f=async e=>(await fetch(`${a}/${e}`,{method:"DELETE"})).json()},752:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{g:()=>o});var s=n(614),i=n(583),a=n(369),r=n(950),l=n(265),c=e([r,s]);[r,s]=c.then?await c:c;class o{constructor(e){var t;this.rootElement=e,this.page=new i.H,this.garage=new s.h,this.navigation=new a.W,this.winners=new r.C,this.rootElement.appendChild(this.navigation.getElement()),this.rootElement.appendChild(this.page.getElement()),this.page.getElement().appendChild(this.garage.getElement()),this.garage.init(),this.winners.init(),document.documentElement.style.setProperty("--race",`${(0,l.w)(null!==(t=this.page.getElement().firstElementChild)&&void 0!==t?t:this.page.getElement())}px`),window.onresize=()=>{var e;document.documentElement.style.setProperty("--race",`${(0,l.w)(null!==(e=this.page.getElement().firstElementChild)&&void 0!==e?e:this.page.getElement())}px`)}}renderGarage(){var e;this.page.getElement().innerHTML="",null===(e=this.garage.cars)||void 0===e||e.forEach((e=>e.resetAnimarion())),this.page.getElement().appendChild(this.garage.getElement())}renderScore(){this.page.getElement().innerHTML="",this.winners.render(),this.page.getElement().appendChild(this.winners.getElement())}}}))},583:(e,t,n)=>{n.d(t,{H:()=>s});class s{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}getElement(){return this.element}}},821:(e,t,n)=>{n.d(t,{x:()=>i});var s=n(583);class i extends s.H{constructor(e,t){super("div",["box"]),this.text=document.createElement("input"),this.text.type="text",this.color=document.createElement("input"),this.color.type="color",this.button=document.createElement("button"),this.button.innerHTML=e,this.button.classList.add("btn"),this.element.append(this.text,this.color,this.button),t&&this.element.classList.add(t)}}},407:(e,t,n)=>{n.d(t,{z:()=>i});var s=n(583);class i extends s.H{constructor(e,t){super("button",["btn"]),this.element.innerHTML=`${e}`,t&&this.element.classList.add(t)}}},973:(e,t,n)=>{n.d(t,{e:()=>i});var s=n(583);class i extends s.H{constructor(e){super(),this.element.innerHTML=`\n    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n\t\tx="0px" y="0px" viewBox="0 0 511 511" style="enable-background:new 0 0 511 511;" xml:space="preserve"; fill=${e}>\n<g>\n\t<path d="M160,307.5h133.538c14.182,0,27.524-7.554,34.82-19.715l14.501-24.169c2.273-3.789,1.045-8.703-2.744-10.976\n\t\tc-3.788-2.273-8.702-1.045-10.976,2.744l-14.501,24.169c-4.421,7.369-12.507,11.947-21.101,11.947H160c-4.418,0-8,3.582-8,8\n\t\tS155.582,307.5,160,307.5z"/>\n\t<path d="M504,323.569V299.5c0-48.523-39.477-88-88-88h-44.209c-12.392-9.747-62.874-48-91.791-48h-54\n\t\tc-11.001,0-21.904,1.664-32.403,4.945c-0.204,0.063-0.404,0.135-0.602,0.215l-73.691,29.675\n\t\tc-11.071,3.427-22.56,5.165-34.152,5.165H58.687c-0.379-0.778-0.884-1.51-1.53-2.157l-7.772-7.772\n\t\tC57.969,189.897,64,181.368,64,171.455V163.5c0-4.418-3.582-8-8-8H8c-4.418,0-8,3.582-8,8v7.955\n\t\tC0,184.713,10.787,195.5,24.045,195.5h4.642l8,8h-6.685C17.87,203.5,8,213.37,8,225.502V291.5c0,18.508,13.298,34.094,33.88,39.714\n\t\tC51.989,345.87,68.888,355.5,88,355.5c15.22,0,29.034-6.112,39.138-16h249.723c10.104,9.888,23.918,16,39.138,16\n\t\ts29.034-6.112,39.138-16H503c4.418,0,8-3.582,8-8C511,327.421,507.945,324.062,504,323.569z M16,171.5h32\n\t\tc-0.024,4.416-3.624,8-8.045,8h-15.91C19.624,179.5,16.024,175.916,16,171.5z M356.287,219.763\n\t\tc-3.571,2.505-6.227,5.165-8.059,7.339l-150.98-14.465C204.31,199.968,218.975,179.5,240,179.5h40\n\t\tC298.891,179.5,336.321,204.724,356.287,219.763z M24,291.5v-65.998c0-3.31,2.692-6.002,6.002-6.002h55.15\n\t\tc13.317,0,26.514-2.014,39.225-5.986c0.204-0.063,0.404-0.135,0.602-0.215l73.433-29.571c-1.999,2.142-3.953,4.431-5.85,6.899\n\t\tc-9.799,12.756-14.805,25.43-15.014,25.963c-0.913,2.336-0.677,4.965,0.638,7.102c1.314,2.136,3.554,3.533,6.051,3.772l167,16\n\t\tc0.28,0.027,0.559,0.041,0.835,0.041c2.931,0,5.573-1.5,6.942-4.153c0.559-0.939,7.435-11.851,24.986-11.851h32\n\t\tc39.701,0,72,32.299,72,72v24h-21.414c3.467-7.279,5.414-15.415,5.414-24c0-30.878-25.122-56-56-56s-56,25.122-56,56\n\t\tc0,8.585,1.947,16.721,5.414,24H138.586c3.467-7.279,5.414-15.415,5.414-24c0-30.878-25.122-56-56-56s-56,25.122-56,56\n\t\tc0,3.313,0.306,6.554,0.86,9.711C27.217,304.609,24,298.428,24,291.5z M48,299.5c0-22.056,17.944-40,40-40s40,17.944,40,40\n\t\ts-17.944,40-40,40S48,321.556,48,299.5z M416,339.5c-22.056,0-40-17.944-40-40s17.944-40,40-40s40,17.944,40,40\n\t\tS438.056,339.5,416,339.5z"/>\n\t<path d="M112,291.5c-4.418,0-8,3.582-8,8c0,8.822-7.178,16-16,16s-16-7.178-16-16s7.178-16,16-16c4.418,0,8-3.582,8-8s-3.582-8-8-8\n\t\tc-17.645,0-32,14.355-32,32s14.355,32,32,32s32-14.355,32-32C120,295.082,116.418,291.5,112,291.5z"/>\n\t<path d="M440,291.5c-4.418,0-8,3.582-8,8c0,8.822-7.178,16-16,16s-16-7.178-16-16s7.178-16,16-16c4.418,0,8-3.582,8-8s-3.582-8-8-8\n\t\tc-17.645,0-32,14.355-32,32s14.355,32,32,32s32-14.355,32-32C448,295.082,444.418,291.5,440,291.5z"/>\n</g>\n</svg>\n  `}}},607:(e,t,n)=>{n.a(e,(async e=>{var t=n(752),s=e([t]);t=(s.then?await s:s)[0],window.onload=()=>{const e=document.getElementById("app");if(!e)throw Error("App root element not found");const n=new t.g(e),s=[{name:"garage",component:()=>{n.renderGarage()}},{name:"winners",component:()=>{n.renderScore()}}],i={name:"default",component:()=>{n.renderGarage()}};window.onpopstate=()=>{const e=window.location.hash.slice(1);(s.find((t=>t.name===e))||i).component()}}}))},265:(e,t,n)=>{n.d(t,{w:()=>i,U:()=>a});var s=n(203);function i(e){const t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.clientWidth-n-100}async function a(e,t){const n=await(0,s.MG)(e),i=await(0,s.H9)(e);404!==n?(0,s.IO)(e,{id:e,wins:i.wins+1,time:t<i.time?t:i.time}):(0,s.P8)({id:e,time:t,wins:1})}},923:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{Z:()=>r});var s=n(203);const{items:i,count:a}=await(0,s.zy)(),r={page:1,cars:i,garageCapasity:a,pageWinners:1,order:"ASC",sort:"time"};e()}),1)},733:(e,t,n)=>{n.d(t,{b:()=>l});var s=n(203),i=n(583),a=n(407),r=n(973);class l extends i.H{constructor(e,t){super("div",["row"]),this.car=e,this.delay=0,this.start=new a.z("a"),this.stop=new a.z("b","invalid"),this.delete=new a.z("delete"),this.select=new a.z("select"),this.pic=new r.e(e.color);const n=new i.H;n.getElement().innerHTML=e.name;const l=new i.H("div",["transmission"]),c=new i.H;l.getElement().append(this.start.getElement(),this.stop.getElement(),this.delete.getElement(),this.select.getElement()),c.getElement().innerHTML='<img class="finish" src="./finish.svg" alt="finish">';const o=new i.H("div",["rase"]);o.getElement().append(this.pic.getElement()),o.getElement().append(c.getElement()),this.element.appendChild(n.getElement()),this.element.appendChild(l.getElement()),this.element.appendChild(o.getElement()),this.start.getElement().addEventListener("click",(async()=>{this.start.getElement().classList.add("invalid"),this.stop.getElement().classList.remove("invalid");const e=await(0,s.BL)(this.car.id);this.pic.getElement().style.animation=`simple ${e.distance/(1e3*e.velocity)}s forwards ease`,!1===(await(0,s.Ag)(this.car.id)).success&&(this.pic.getElement().style.animationPlayState="paused")})),this.stop.getElement().addEventListener("click",(async()=>{0===(await(0,s.sT)(this.car.id)).velocity&&(this.pic.getElement().style.animation="",this.start.getElement().classList.remove("invalid"),this.stop.getElement().classList.add("invalid"))})),this.delete.getElement().addEventListener("click",(async()=>{await(0,s.tD)(this.car.id),(0,s.BS)(this.car.id),t.render()})),this.select.getElement().addEventListener("click",(async()=>{t.setUpdateBox(this.car)}))}async setDelay(){this.start.getElement().classList.add("invalid"),this.stop.getElement().classList.remove("invalid");const e=await(0,s.BL)(this.car.id);this.delay=e.distance/(1e3*e.velocity)}async race(){return this.pic.getElement().style.animation=`simple ${this.delay}s forwards ease`,!1===(await(0,s.Ag)(this.car.id)).success?(this.pic.getElement().style.animationPlayState="paused",{time:40,id:this.car.id,name:this.car.name}):{time:this.delay,id:this.car.id,name:this.car.name}}reset(){(0,s.sT)(this.car.id),this.pic.getElement().style.animation="",this.start.getElement().classList.remove("invalid"),this.stop.getElement().classList.add("invalid")}resetAnimarion(){this.pic.getElement().style.animation=""}}},614:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{h:()=>h});var s=n(203),i=n(583),a=n(923),r=n(821),l=n(407),c=n(733),o=n(265),d=e([a]);a=(d.then?await d:d)[0];class h extends i.H{constructor(){super("div",["container","page"]),this.header=new i.H("div",["header"]),this.element.append(this.header.getElement()),this.addForm=new i.H("div",["add-form"]),this.createBox=new r.x("create"),this.modifyBox=new r.x("update","invalid"),this.prevBtn=new l.z("<"),this.nextBtn=new l.z(">"),this.rasePanel=new i.H("div",["rase-box"]),this.raceBtn=new l.z("race"),this.resetBtn=new l.z("reset"),this.rasePanel.getElement().append(this.raceBtn.getElement(),this.resetBtn.getElement()),this.pagination=new i.H("div",["pagination"]),this.pagination.getElement().append(this.prevBtn.getElement(),this.nextBtn.getElement()),this.addForm.getElement().append(this.createBox.getElement(),this.modifyBox.getElement(),this.rasePanel.getElement(),this.pagination.getElement()),this.element.append(this.addForm.getElement()),this.list=new i.H("div",["garage"]),this.element.append(this.list.getElement())}init(){this.render();const e=this.createBox.button,t=this.modifyBox.button,n=this.createBox.text,{color:i}=this.createBox,r=this.modifyBox.text,l=this.modifyBox.color;e.addEventListener("click",(async()=>{var e,t;await(0,s.DT)({color:null!==(e=null==i?void 0:i.value)&&void 0!==e?e:"",name:null!==(t=null==n?void 0:n.value)&&void 0!==t?t:""}),this.render()})),t.addEventListener("click",(async()=>{await(0,s.Bo)(Number(t.dataset.id),{color:l.value,name:r.value}),this.render(),this.modifyBox.getElement().classList.add("invalid"),l.value="#FFF",r.value=""})),this.nextBtn.getElement().addEventListener("click",(async()=>{a.Z.page++,this.render()})),this.prevBtn.getElement().addEventListener("click",(async()=>{a.Z.page--,this.render()})),this.raceBtn.getElement().addEventListener("click",(async()=>{var e,t;this.raceBtn.getElement().classList.add("invalid");const n=null===(e=this.cars)||void 0===e?void 0:e.map((e=>e.setDelay()));n&&await Promise.all(n);const s=null===(t=this.cars)||void 0===t?void 0:t.map((e=>e.race()));s&&await Promise.all(s).then((async e=>{const t=e.map((e=>e.time));if(e){const n=Math.min(...t),s=Math.ceil(1e3*n)/1e3,i=e.filter((e=>e.time===n));if(40===s)return void alert("All engines was broken..");alert(`Race is finished with best time: ${s} sec. Winner: ${i[0].name}`);const{id:a}=i[0];(0,o.U)(a,s)}}))})),this.resetBtn.getElement().addEventListener("click",(()=>{var e;null===(e=this.cars)||void 0===e||e.forEach((e=>{e.reset()})),this.raceBtn.getElement().classList.remove("invalid")}))}async render(){const{items:e,count:t}=await(0,s.zy)(a.Z.page);this.cars=[],a.Z.cars=e,a.Z.garageCapasity=t,this.header.getElement().innerHTML=`<h3>Garage (${a.Z.garageCapasity})</h3><h3>Page #${a.Z.page}</h3>`,this.list.getElement().innerHTML="",a.Z.cars.forEach((e=>{var t;const n=new c.b(e,this);this.list.getElement().append(n.getElement()),null===(t=this.cars)||void 0===t||t.push(n)})),7*a.Z.page>Number(a.Z.garageCapasity)?this.nextBtn.getElement().classList.add("invalid"):this.nextBtn.getElement().classList.remove("invalid"),a.Z.page>1?this.prevBtn.getElement().classList.remove("invalid"):this.prevBtn.getElement().classList.add("invalid")}setUpdateBox(e){const t=this.modifyBox.getElement(),n=this.modifyBox.text,{color:s}=this.modifyBox,i=this.modifyBox.button;t.classList.remove("invalid"),n.value=e.name,s.value=e.color,i.dataset.id=String(e.id)}}}))},369:(e,t,n)=>{n.d(t,{W:()=>i});var s=n(583);class i extends s.H{constructor(){super("header",[]),this.element.innerHTML='\n    <div class="container">\n    <div class="nav">\n    <nav>\n      <ul class="navigation">\n          <a href="#garage" class="active"><li>Garage</li></a>\n          <a href="#winners" id="best-score"><li>Winners</li></a>\n      </ul>\n    </nav>\n    </div>\n    </div>\n    ';const e=this.element.querySelectorAll("a");e.forEach((t=>{t.addEventListener("click",(()=>{null==e||e.forEach((e=>{e.classList.remove("active")})),t.classList.add("active")}))}))}}},152:(e,t,n)=>{n.d(t,{E:()=>a});var s=n(583),i=n(973);class a extends s.H{constructor(e,t){super("div",["row","winner"]);const n=new i.e(t.color),a=new s.H("div",["number"]);a.getElement().innerHTML=`${e.id}`;const r=new s.H("div");r.getElement().innerHTML=`${t.name}`;const l=new s.H("div");l.getElement().innerHTML=`${e.wins}`;const c=new s.H("div");c.getElement().innerHTML=`${e.time}`,this.element.append(a.getElement(),n.getElement(),r.getElement(),l.getElement(),c.getElement())}}},950:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{C:()=>o});var s=n(203),i=n(583),a=n(407),r=n(923),l=n(152),c=e([r]);r=(c.then?await c:c)[0];class o extends i.H{constructor(){super("div",["container","page"]),this.prevBtn=new a.z("<"),this.nextBtn=new a.z(">"),this.pagination=new i.H("div",["pagination"]),this.pagination.getElement().append(this.prevBtn.getElement(),this.nextBtn.getElement()),this.form=new i.H("div",["add-form"]),this.form.getElement().append((new i.H).getElement(),this.pagination.getElement()),this.header=new i.H("div",["header"]),this.tableHeader=new i.H("div",["header","table-header","row"]),this.tableHeader.getElement().innerHTML='\n    <h4 class="sort" id="id">#</h4>\n    <h4>Car</h4>\n    <h4>Name</h4>\n    <h4 class="sort" id="wins">Wins</h4>\n    <h4 class="sort asc" id="time">Best Time</h4>',this.list=new i.H,this.element.append(this.header.getElement(),this.form.getElement(),this.tableHeader.getElement(),this.list.getElement())}init(){this.render(),this.nextBtn.getElement().addEventListener("click",(async()=>{r.Z.pageWinners++,this.render()})),this.prevBtn.getElement().addEventListener("click",(async()=>{r.Z.pageWinners--,this.render()}));const e=this.element.querySelectorAll(".sort");e.forEach((t=>{t.addEventListener("click",(()=>{let n="asc";t.classList.contains("asc")&&(n="desc"),null==e||e.forEach((e=>{e.classList.remove("asc","desc")})),t.classList.add(n),r.Z.order=n.toUpperCase(),r.Z.sort=t.id,this.render()}))}))}async render(){const{items:e,count:t}=await(0,s.ix)(r.Z.pageWinners,10,r.Z.order,r.Z.sort);this.header.getElement().innerHTML=`<h3>Winners (${t})</h3><h3>Page #${r.Z.pageWinners}</h3>`,this.list.getElement().innerHTML="",e.forEach((async e=>{const t=await(0,s.oX)(e.id),n=new l.E(e,t);this.list.getElement().append(n.getElement())})),10*r.Z.pageWinners>Number(t)?this.nextBtn.getElement().classList.add("invalid"):this.nextBtn.getElement().classList.remove("invalid"),r.Z.pageWinners>1?this.prevBtn.getElement().classList.remove("invalid"):this.prevBtn.getElement().classList.add("invalid")}}}))}},r={};function l(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return a[e](n,n.exports,l),n.exports}e="function"==typeof Symbol?Symbol("webpack then"):"__webpack_then__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n=e=>{e&&(e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},s=e=>!--e.r&&e(),i=(e,t)=>e?e.push(t):s(t),l.a=(a,r,l)=>{var c,o,d,h=l&&[],m=a.exports,g=!0,p=!1,v=(t,n,s)=>{p||(p=!0,n.r+=t.length,t.map(((t,i)=>t[e](n,s))),p=!1)},E=new Promise(((e,t)=>{d=t,o=()=>(e(m),n(h),h=0)}));E[t]=m,E[e]=(e,t)=>{if(g)return s(e);c&&v(c,e,t),i(h,e),E.catch(t)},a.exports=E,r((a=>{if(!a)return o();var r,l;c=(a=>a.map((a=>{if(null!==a&&"object"==typeof a){if(a[e])return a;if(a.then){var r=[];a.then((e=>{l[t]=e,n(r),r=0}));var l={[e]:(e,t)=>(i(r,e),a.catch(t))};return l}}return{[e]:e=>s(e),[t]:a}})))(a);var d=new Promise(((e,n)=>{(r=()=>e(l=c.map((e=>e[t])))).r=0,v(c,r,n)}));return r.r?d:l})).then(o,d),g=!1},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l(607)})();